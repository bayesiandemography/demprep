---
title: "Overview of the 'demprep' Package"
output: rmarkdown::html_vignette
vignette: >
    %\VignetteIndexEntry{Overview of the 'demprep' Package}
    %\VignetteEngine{knitr::rmarkdown}
    %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
library(knitr)
library(demprep)
opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  echo = TRUE,
  fig.width = 6.5,
  fig.align = "center"
)
deaths <- data.frame(name = c("Anwar", "Baptiste", "Candice"),
                     date_birth = c("2014-02-17", "2012-01-10", "2019-04-29"),
                     date_death = c("2019-10-11", "2020-02-27", "2020-08-01"))

births_in <- data.frame(date_child = c("2020-05-18", "2020-07-02", "2020-10-05"),
                        date_parent = c("2000-02-14", "2002-05-18", "1990-12-18"))

births_out <- data.frame(date_child = c("2020-03-14", "2020-08-22"),
                         date_parent = c("1968-01-23", "2008-03-05"))
```

# Introduction

Demographic analyses typically work with data that has been arranged into tables like this:
```{r deaths-array, echo = FALSE}
deaths_array <- matrix(c(3, 0, 1, 5, 0, 2, 4, 0, 2),
                       nrow = 3, 
                       ncol = 3,
                       dimnames = list(age = c("0-4", "5-9", "10-14"),
                                       year = 2020:2022))
kable(deaths_array,
      align = "c",
      caption = "Counts of deaths by age group and year")
```
Events are categorised into age groups and periods. The age groups and periods have standardised widths, with standard labels.

Raw demographic data from registration systems or surveys, however, typically comes in formats like this:
```{r deaths-raw, echo = FALSE}
deaths_raw <- data.frame(name = c("Alice", "Bilal", "Clara", "Djeneba", "Ergi", "Faisal"),
                               date_of_birth = c("2022-04-17", "2009-12-03", "2020-07-01",
     			                         "2011-11-29", "2020-05-16", "2018-03-30"),
			       date_of_death = c("2022-07-19", "2021-10-18", "2022-14-16",
     			                         "2022-08-07", "2020-06-03", "2020-01-13"))
kable(deaths_raw,
      caption = "Deaths by date of birth and date of death")
```
The data consists of individual events, rather than counts. The events themselves are indexed by dates, rather than being assigned to age groups and periods. Even when the data does not come in a completely raw form, it often looks something like this:
```{r deaths-semiclean, echo = FALSE}
deaths_semiclean <- data.frame(age = c("Infant", "2 years", "12 years",
                                       "Infants", "1 year"),
                               year = c(2020, 2020, 2020,
                                        2021, 2021),
                               count = c(2, 1, 1, 3, 2))
kable(deaths_semiclean,
      caption = "Deaths by age group and year")
```
Some age groups are missing from the data, and the labels for the age groups follow non-standard conventions.

Getting from raw, or semi-raw, data to tabulations ready for demographic analysis can be harder than it looks. Consider, for instance, a person born on 31 January 2001. On what date does that person become one month old? According base *R* function `seq.Date`, the answer is 3 March 2001:
```{r one-month}
seq.Date(from = as.Date("2001-01-31"), 
         by = "month",
         length.out = 2)
```

Package **demprep** provides functions for processing demographic data to the point where the data is ready to be analysed using the other **dem** packages. **demprep** focuses in particular on the processing of information related to age and time, since this is usually the hardest part of preparing demographic data, and since *R* currently lacks tools for processing age and time information into standard demographic formats.

In this vignette, we start with some definitions and conventions, including the rules that **demprep** follows for measuring age and constructing labels. Next we examine each of the main groups of functions. We then show how these functions can be used in practice, through two realistic case studies.  We conclude by describing how functions in **demprep** can be used alongside functions from base *R* and from other packages, when preparing demographic data.

# Definining age groups, periods, cohorts, and Lexis triangles

When describing individual people or events, we can use precise ages or times: this person is 11 years and 5 days old, or this event happened on 2 February 2021. But when describing groups of people or events, we use intervals: these people are between 10 and 15 years old, or these events occurred during the year 2021. 

One way to visualise intervals for age and time is through a Lexis diagram. The figure below is an example. The horizontal axis measures calendar time, and the vertical axis measures age. The vertical lines mark out dates. The intervals between the dates in the diagram are periods. The period 2000-2015, for instance, starts on 2000-01-01 and ends just before 2005-01-01. Similarly, the horizontal lines mark out exact ages, and the intervals between the exact ages are age groups. The age group 5-9, for instance, start with exact age 5, and ends just before exact age 10.

```{r agetime, echo = FALSE}
date <- as.Date(c("2020-12-07", "2022-05-30"))
dob <- as.Date(c("2001-07-22", "2006-03-14"))
age <- c(19 + 4.5/12, 16 + 2.5/12)
```


```{r lexis1, echo = FALSE, fig.width = 5, fig.height = 5, fig.cap = "A Lexis diagram"}
breaks_time <- seq.Date(from = as.Date("2000-01-01"),
                        to = as.Date("2025-01-01"), 
                        by = "5 years")
breaks_age <- seq.int(from = 0L, 
                      to = 25L, 
                      by = 5L)
year <- as.integer(format(breaks_time, "%Y"))
labels_time <- demprep:::make_labels_period_custom(year,
                                                   include_na = FALSE)
labels_age <- demprep:::make_labels_age(breaks = breaks_age,
                              open_last = FALSE,
                              include_na = FALSE)
demprep:::plot_date_to_age_triangle(date = date,
                                    dob = dob,
                                    unit = "year",
                                    breaks_time = breaks_time,
                                    breaks_age = breaks_age,
                                    labels_time = labels_time,
                                    labels_age = labels_age,
                                    show_vert = TRUE,
                                    show_diag = TRUE,
                                    show_months = FALSE)
text(x = date,
     y = age,
     labels = expression(italic(A), italic(B)),
     pos = 4)
```

A birth cohort is a group of people who were born during the same period. The diagonal lines in the Lexis diagram mark the borders between cohorts. In the Lexis diagram above, for instance, the birth cohort 2000-2005 starts at the bottom left of the diagram, and ends at the top left.

Cohorts can be defined by events other than birth. People marrying during the same decade form a type of cohort, for instance, as do people joining an organization during the same year. However, birth cohorts are the most common type of cohort, and when the term "cohort" is used without any sort of qualifier, it generally means "birth cohort".

The black dots $A$ and $B$ in the Lexis diagram represent deaths, and the black diagonal lines are "life lines" for the people experiencing these deaths. The two deaths belong to the same period (2020-2025) and age group (15-19). Death $A$, however, belongs to cohort 2000-2005, while death $B$ belongs to cohort 2005-2010. Period and age group do not, by themselves, contain enough information to unambiguously assign events to cohorts. 

To unambiguously assign events to cohorts, we need on additional piece of information: the Lexis triangle to which the event belongs. Lexis triangles are defined by combinations of the horizontal, vertical, and diagonal lines in Lexis diagrams. Event $A$, for example, belongs to the upper Lexis triangle for period 2020-2025 and age group 15-19, and event $B$ belongs to the lower Lexis triangle.  

Cohorts, and Lexis triangles require time steps and age steps to have equal sizes. In the Lexis diagram above, for instance, the time steps and age steps are both 5 years. However, demographic data does not always use the same size steps for age and time. The Lexis diagram beow, for instance, has 10-year time steps and 5-year age steps. 

```{r lexis2, echo = FALSE, fig.width = 5, fig.height = 5, fig.cap = "A Lexis diagram with time steps and age steps of different lengths"}
breaks_time <- seq.Date(from = as.Date("2000-01-01"),
                        to = as.Date("2030-01-01"), 
                        by = "10 years")
breaks_age <- seq.int(from = 0L, 
                      to = 25L, 
                      by = 5L)
year <- as.integer(format(breaks_time, "%Y"))
labels_time <- demprep:::make_labels_period_custom(year,
                                                   include_na = FALSE)
labels_age <- demprep:::make_labels_age(breaks = breaks_age,
                                        open_last = FALSE,
                                        include_na = FALSE)
demprep:::plot_date_to_age_triangle(date = date,
                                    dob = dob,
                                    unit = "year",
                                    breaks_time = breaks_time,
                                    breaks_age = breaks_age,
                                    labels_time = labels_time,
                                    labels_age = labels_age,
                                    show_vert = TRUE,
                                    show_diag = FALSE,
                                    show_months = FALSE)
text(x = date,
     y = age,
     labels = expression(italic(A), italic(B)),
     pos = 4)
```


## How **demprep** measures age

In ordinary English, "age" means "age in completed years" or "age at last birthday". Demographers typically adopt this same rule when specifying ages in years. For instance, demographers describe as a person who was born 5 years and 57 days ago as "5 years old", and describe a person who was born 2 days ago as 0 years old.

Demographers extend the same rule to measuring age in months. Thus, for instance, demographers describe a person who was born 3 months as 23 days ago as "3 months old".

Some applications require describing ages in three-month units called "quarters". The age-in-completed-units approach can be applied to quarters. A person who was born 3 months and 23 days ago can be referred to as "1 quarter old".

Whether using years, months, or quarters, however, the measurement of age is complicated by the fact that some months are longer than others. April has 30 days, while May has 31, for instance, and February has 29 days in leap years and 28 days in non-leap years. The question of when a person born on 31 January 2001 turns 1 month old is difficult to answer because February is shorter than January. 

One approach to the problem of measuring ages with unequal months is to define new month-like units consisting of, say, 365/12 days, and use these instead. While this approach might be suitable for some purposes, it is unsuitable for most tasks in applied demography, where people want to know what has happened, or will happen, during conventionally-labelled months or years. Using artificial months that were 365/12 days long would mean that reaching three months of age always required experiencing three times as many days as reaching one month of age. However, because the new artificial months would not line up with standard months, any recording system based on these months would be unable to answer the questions that most users of demographic statistics were likely to ask. Users of monthly birth statistics want to know, for instance, how many births occurred during 1 June--30 June, for instance, not some artificial period of 365/12 days that approximately aligns with 1 June--30 June.

To obtain data that respects the boundaries between standard months and years, we need to incorporate these months and years into our calculations of variables such as age. In **demprep** we calculate age in months using the formula
\begin{equation}
\begin{split}
\text{age in completed months} & = 12 \times (\text{year of event} - \text{year of birth}) \\
& \quad + \text{month of event} - \text{month of birth} \\
& \quad - I\{\text{day of event} \ge \text{day of birth}\}.
\end{split}
\end{equation}
The $I\{\text{day of event} \ge \text{day of birth}\}$ translates as "1 if the day of event is greater than or equal to day of birth, and 0 otherwise".

Consider, for instance, a person born on 2 January 2020 who emigrates on 13 March 2030. We calculate the age of the person at the time of the emigration as follows:
\begin{align} 
  \text{age in completed months} & = 12 \times (2030 - 2020) + (3 - 1) + 1 \\
                                 & = 123.
\end{align}

Using this approach a child who was born in 31 January 2001 is 0 months old on 28 February, and 1 month old on 1 March. The approach therefore implies that the child turns one month old on 1 March, which is a different answer from the one implied by function `seq.Date`.

Age in completed years can be obtained by dividing age in completed months by 12, and discarding any remainder. If a person is aged 123 in completed months, then the person is aged 10 in completed years. (The corresponding *R* operation is integer division, obtained through the `%/%` operator.)

Similarly, age in completed quarters can be obtained by dividing age in completed months by 3 and dividing any remainder. If a person is aged 123 in completed months, then that person is aged 41 in completed quaters.


# **demprep** labels for age groups, periods, and cohorts

The conventions that **demprep** uses for labelling age groups, periods, and cohorts are summarised in the following table.


Table: Examples of **demprep** labels for age groups, periods, and cohorts

| Unit  | Type   | Age group | Period     | Cohort       |
|:------|:-------|:----------|:-----------|:-------------|
| year  | single | `"0"`     | `"2020"`   | `"2020"`     |
| year  | multiple |  `"5-9"` | `"2025-2030"` | `"2025-2030"` |
| year  | open left |  |  | `"<2020"` |
| year  | open right | `"100+"` |  |  |
| quarter | single | `"12"` | `"2020 Q1"` | `"2020 Q1"` |
| quarter  | multiple |  |  |  |
| quarter | open left |  |  | `"<2020 Q1"` |
| quarter | open right | `"12+"` |  |  |
| month | single | `"12"` | `"2020 Q1"` | `"2020 Q1"` |
| month  | multiple |  |  |  |
| month | open left |  |  | `"<2020 Jan"` |
| month | open right | `"36+"` |  |  |


Choosing appropriate labels for age groups, periods, and cohorts is non-trivial. Demographers have never developed a universally-accepted set of labelling conventions. Moreover, the conventions that do exist lead to labels that are ambiguous.

Labels for age groups pose the fewest problems. When an age group extends over more than one year, demographers almost always use labels such as "20-24", which includes anyone whose age in completed years is 20, 21, 22, 23 or 24. When referring to a mix of single-year and multiple-year age groups, demographers use a mix of single-year and multiple-year labels, as in "0, 1-4, 5-9, 10-14". When 







Table: Intervals that the period or cohort label "2020" can refer to

| Label uses start year | Label uses end year   |
|:----------------------:|:----------------------:|
| 1 Jan 2020 - 31 Dec 2020 | 1 Feb 2019 - 31 Jan 2020 |
| 1 Feb 2020 - 31 Jan 2021 | 1 Mar 2019 - 29 Feb 2020 |
| 1 Mar 2020 - 28 Feb 2021 | 1 Apr 2019 - 31 Mar 2020 |
| 1 Apr 2020 - 31 Mar 2021 | 1 May 2019 - 30 Apr 2020 |
| 1 May 2020 - 30 Apr 2021 | 1 Jun 2019 - 31 May 2020 |
| 1 Jun 2020 - 31 May 2021 | 1 Jul 2019 - 30 Jun 2020 |
| 1 Jul 2020 - 30 Jun 2021 | 1 Aug 2019 - 31 Jul 2020 |
| 1 Aug 2020 - 31 Jul 2021 | 1 Sep 2019 - 31 Aug 2020 |
| 1 Sep 2020 - 31 Aug 2021 | 1 Oct 2019 - 30 Sep 2020 |
| 1 Oct 2020 - 30 Sep 2021 | 1 Nov 2019 - 31 Oct 2020 |
| 1 Dec 2020 - 30 Nov 2021 | 1 Dec 2019 - 30 Nov 2020 |






**Measuring periods using using dates attained, rather than days elapsed***

In everyday usage, the endpoints of a period depend on dates attained rather than days elapsed. The period from 1 January 2020 to 1 January 2021 and the period from 1 January 2021 to 1 January 2022 both count as one year, even though the first period has 366 days and the second has 365. Similarly, the period from 1 June to 1 July and the period from 1 July to 1 August both count as one month, even though the first period has 30 days and the second has 31.

In the case of years, periods are defined by lining up the days of the month and the month of the year, and then calculating at the difference in years. For instance, 30 June 2014 and 30 June 2017 are suitably aligned, so we can conclude that the two dates are 3 years apart. 

In the case of months, periods are defined by lining up days of the month and then calculating the difference month. For instance, 1 January 2000 and 1 April 2001 are suitably aligned, so we can conclude that the two dates are 15 months (or, equivalently, one year and three months) apart.

Sometimes, however, it is not possible to align days and months. If we want to go one year forward from 29 February 2020, we there is no 29 February 2021 to align to. As noted above, a similar problem arises when trying to go one month forward from 31 January in any year. These sorts of problems arise for days of the month, such as the 31st, that occur in some months but not others.

**demprep** sidesteps the problem of irregular days of the month by requiring that all periods start on the first of the month. For example, year-long periods can begin on any month of the year, but they must always begin on the first day of the month. A period beginning on 1 December is allowed, but a period beginning on 2 January is not. This restriction makes the practice of defining periods simpler and more predictable, and is consistent with what most producers of data do in any case.






# Calculating ages, periods, cohorts, and Lexis diagrams from data on dates 

| Periods | Cohorts | Age groups | Lexis triangles |
|:--------|:--------|:-----------|:----------------|
| `date_to_period_year` | `date_to_cohort_year` | `date_to_age_year` | `date_to_triangle_year` |
| `date_to_period_quarter` | `date_to_cohort_quarter` | `date_to_age_quarter` | `date_to_triangle_quarter` |
| `date_to_period_month` | `date_to_cohort_month` | `date_to_age_month` | `date_to_triangle_month` |

The last part of the name of each function refers to units that are created.


## Periods

We begin with function `date_to_period_year`, which assigns dates to 1-year periods. We illustrate this, and other functions, using the dataset introduced above:
```{r deaths}
deaths
```
By default, `date_to_period_year` creates periods that start on 1 January. To demonstrate, using a dataset, introduced above, called `deaths`:
```{r}
deaths
```
We make a temporary copy of `deaths`, and then call `date_to_period_year` on the `date_death` column, using the default settings for `date_to_period_year`. By default, `date_to_period_year` constructs periods that start on 1 January:
```{r}
deaths_temp <- deaths
deaths_temp$period_jan <- date_to_period_year(date = deaths_temp$date_death)
deaths_temp
```
The two periods created by `date_to_period_year` are depicted below. 
```{r, echo = FALSE, fig.height = 1.75}
demprep:::plot_date_to_period_year(date = deaths$date_death)
```
The first starts on 1 January 2019, and the second starts on 1 January 2020.

To create periods that start on a date other than 1 January, we use the `month_start` argument:
```{r}
deaths_temp$period_jul <- date_to_period_year(date = deaths_temp$date_death,
                                              month_start = "Jul")
deaths_temp
```
The resulting periods start on 1 July 2019 and 1 July 2020:
```{r, echo = FALSE, fig.height = 1.75}
demprep:::plot_date_to_period_year(date = deaths_temp$date_death,
                         month_start = "Jul")
```

The first of these periods spans calendar years 2019 and 2020, and the second spans calendar years 2020 and 2021. By default, `date_to_period_year` labels single-year periods using the calendary year at the start of the period. The periods above are therefore labelled "2019" and "2020". Authorities follow a different convention, and refer to the periods above as the year to June 2020, and the year to June 2021, leading to the labels "2020" and "2021". To create labels based on the calendar year at the end of each period, rather than the calendar year at the begining, we set the `label_year_start` argument of `date_to_period_year` to `FALSE`:
```{r}
deaths_temp$period_jul_end <- date_to_period_year(date = deaths_temp$date_death,
                                                  month_start = "Jul",
                                                  label_year_start = FALSE)
deaths_temp
```

The resulting periods are defined by exactly the same dates as the previous ones, but have different labels.
```{r, echo = FALSE, fig.height = 1.75}
demprep:::plot_date_to_period_year(date = deaths_temp$date_death,
                         month_start = "Jul",
                         label_year_start = FALSE)
```

When one-year periods start on 1 January, the question of whether to label by the start year or the end year does not arise, since the period falls within a single calendar year.

`date_to_period_year` creates enough periods so that every element of the `date` argument can be assigned to a period. As the following example demonstrates, `date_to_period_year` also, by default, fills in any gaps between the first and last period, even if the resulting periods do not contain any elements from `date`. We first create a dataset with no deaths during the year 2018.
```{r}
deaths_temp <- rbind(deaths,
                     data.frame(name = "Ding", 
                                date_birth = "2017-03-18",
                                date_death = "2017-07-15"))
deaths_temp$period <- date_to_period_year(date = deaths_temp$date_death)
deaths_temp
```


Quarters are three-month periods starting on the first day of January, April, July, and October:
```{r}
deaths_temp <- deaths
deaths_temp$time <- date_to_period_quarter(deaths_temp$date_death)
deaths_temp
```

```{r, echo = FALSE, fig.height = 1.75}
demprep:::plot_date_to_period_quarter(deaths_temp$date_death)
```

Month-length periods are similarly straightforward:
```{r}
deaths_temp <- deaths
deaths_temp$time <- date_to_period_month(deaths_temp$date_death)
deaths_temp
```

```{r, echo = FALSE, fig.height = 1.75}
demprep:::plot_date_to_period_month(deaths_temp$date_death[1:2])
```


## Ages

Abstract: $\text{age} = t_{\text{event}} - t_{\text{dob}}$

Complications. 

- Child born on 31 October. On what day does child become 1 month old? 
- Child born on 30 November. On what day does child become 1 month old?
- Child born on 29 February 2000. On what day does child become 1 year old? [1 March 2001]

Principles:
- tick over when day of date equals day of dob. Includes leap years.

\begin{equation}
\begin{split}
\text{age in completed months} & = 12 \times (\text{year of event} - \text{year of birth}) \\
& \quad + \text{month of event} - \text{month of birth} \\
& \quad - \text{partial-month adjustment}
\end{split}
\end{equation}

Partial-month adjustment: if $\text{day of event} \ge \text{day of birth}$, then 0; otherwise 1.


```{r, echo = FALSE, fig.height = 6.5}
date <- as.Date(c("2021-03-30", "2021-03-10"))
dob <- as.Date(c("2021-01-30", "2021-01-10"))
demprep:::plot_date_to_age_month(date = date,
                       dob = dob)
```

\begin{equation}
\text{age in completed quarters} = \text{floor}(\text{age in completed months} / 3)
\end{equation}

\begin{equation}
\text{age in completed quarters} = \text{floor}(\text{age in completed months} / 12)
\end{equation}


| Relationship between dates | Age in completed years |
|:---------------------------|:-----------------------|
| $\text{month of event} > \text{month of birth}$ | $\text{year of event} - \text{year of birth}$ |
| $\text{month of event} = \text{month of birth}$, $\text{day of event} \ge \text{day of birth}$ | $\text{year of event} - \text{year of birth}$ |
| $\text{month of event} = \text{month of birth}$, $\text{day of event} \lt \text{day of birth}$ | $\text{year of event} - \text{year of birth} - 1$ |
| $\text{month of event} < \text{month of birth}$ | $\text{year of event} - \text{year of birth} - 1$ |



```{r}
dth_age_yr <- deaths
dth_age_yr$age_10 <- date_to_age_year(date = dth_age_yr$date_death,
                                      dob = dth_age_yr$date_birth)
dth_age_yr
```


```{r}
dth_age_month <- deaths
dth_age_month$age <- date_to_age_month(date = dth_age_month$date_death,
                                       dob = dth_age_month$date_birth)
dth_age_month
```
```{r}
dth_age_quarter <- deaths
dth_age_quarter$age <- date_to_age_quarter(date = dth_age_quarter$date_death,
                                           dob = dth_age_quarter$date_birth)
dth_age_quarter
```



## Cohorts

same as periods

```{r}
deaths_temp <- deaths
deaths_temp$cohort <- date_to_cohort_year(date = deaths_temp$date_birth)
deaths_temp
```

```{r, echo = FALSE, fig.height = 1.75}
demprep:::plot_date_to_cohort_year(date = deaths_temp$date_birth)
```



# Lexis triangles

- age and time use same length steps (subject to complications of months and years having different lengths, plus open age group)
- one month; one quarter; one year; $n$ years
- age and time not enough to identify cohort; also need Lexis triangle
- abstract: 
- event is in upper Lexis triangle

- An event occurring during period $t$ to a person in age group $a$ belongs to the lower Lexis triangle if the person attains age $a$ during, and to the upper Lexis triangle otherwise. (Covers youngest and oldest age groups.)


- If index of time equals index for age, then Lower; else Upper.

How to work out triangle:

1. Use date now and dob to calculate age group now
2. Use date now to identify date at start of period
3. Use date at start of period and dob to calculate whether entered age group during period
4. If so, lower; if not upper.



```{r}
dth_tri_yr <- deaths
dth_tri_yr$tri_jan <- date_to_triangle_year(date = dth_age_yr$date_death,
                                            dob = dth_age_yr$date_birth)
dth_tri_yr
```

```{r, echo = FALSE, fig.height = 6.5}
demprep:::plot_date_to_triangle_year(date = dth_tri_yr$date_death,
                                     dob = dth_tri_yr$date_birth)
```

Change from 1 Jan to 1 Jul

```{r}
dth_tri_yr$tri_jul <- date_to_triangle_year(date = dth_age_yr$date_death,
                                            dob = dth_age_yr$date_birth,
                                            month_start = "Jul")
dth_tri_yr
```

```{r}
dth_tri_qu <- deaths
dth_tri_qu$tri <- date_to_triangle_quarter(date = dth_tri_qu$date_death,
                                           dob = dth_tri_qu$date_birth)
dth_tri_qu
```

```{r}
dth_tri_month <- deaths
dth_tri_month$tri <- date_to_triangle_month(date = dth_tri_month$date_death,
                                            dob = dth_tri_month$date_birth)
dth_tri_month
```



# Cleaning existing labels


# Creating final labels

| Periods | Cohorts | Age groups | Lexis triangles |
|:--------|:--------|:-----------|:----------------|
| `format_period_year` | `format_cohort_year` | `format_age_year` | `format_triangle_year` |
| `format_period_multi` | `format_cohort_multi` | `format_age_multi` | `format_triangle_multi` |
| `format_period_custom` | `format_cohort_custom` | `format_age_custom` | \<none\> |
| \<none\> | \<none\> | `format_age_lifetab`| \<none\> |
| \<none\> | \<none\> | `format_age_births` | `format_triangle_births` |
| `format_period_quarter` | `format_cohort_quarter` | `format_age_quarter` | `format_triangle_quarter` |
| `format_period_month` | `format_cohort_month` | `format_age_month` | `format_triangle_month` |



# Tabulation